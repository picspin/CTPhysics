(()=>{var e={};e.id=815,e.ids=[815],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4801:(e,t,n)=>{"use strict";n.r(t),n.d(t,{GlobalError:()=>o.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>c,routeModule:()=>p,tree:()=>d}),n(4428),n(6441),n(5866);var i=n(3191),r=n(8716),a=n(7922),o=n.n(a),s=n(5231),l={};for(let e in s)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>s[e]);n.d(t,l);let d=["",{children:["dual-energy",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(n.bind(n,4428)),"E:\\Projects\\CTPhysics\\app\\dual-energy\\page.jsx"]}]},{}]},{layout:[()=>Promise.resolve().then(n.bind(n,6441)),"E:\\Projects\\CTPhysics\\app\\layout.jsx"],"not-found":[()=>Promise.resolve().then(n.t.bind(n,5866,23)),"next/dist/client/components/not-found-error"]}],c=["E:\\Projects\\CTPhysics\\app\\dual-energy\\page.jsx"],u="/dual-energy/page",m={require:n,loadChunk:()=>Promise.resolve()},p=new i.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/dual-energy/page",pathname:"/dual-energy",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},8884:(e,t,n)=>{Promise.resolve().then(n.bind(n,6121))},6592:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(326);n(7577);let r=({tabs:e,activeTab:t,onChange:n,className:r=""})=>(0,i.jsxs)("div",{className:`mb-6 overflow-x-auto ${r}`,children:[i.jsx("div",{className:"flex space-x-2",children:e.map(e=>i.jsx("button",{onClick:()=>n(e.id),className:`whitespace-nowrap rounded-xl px-4 py-2.5 text-sm font-medium transition-all duration-300 ${t===e.id?"bg-primary-100 text-white shadow-md":"bg-bg-200/70 text-text-200 hover:bg-bg-300/50 hover:text-text-100"}`,children:e.label},e.id))}),i.jsx("div",{className:"mt-2 h-0.5 w-full bg-bg-300/50",children:e.map(n=>i.jsx("div",{className:`h-full transition-all duration-300 ${t===n.id?"bg-primary-100":"bg-transparent"}`,style:{width:`${100/e.length}%`,transform:`translateX(${100*e.findIndex(e=>e.id===t)}%)`}},n.id))})]})},6121:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>es});var i=n(326),r=n(7577),a=n.n(r),o=n(4445),s=n(891),l=n(6777),d=n(1910),c=n(660),u=n(9844),m=n(8423),p=n(2637),h=n(9997),f=n(4675),v=n(9274),y=n(5219),b=n(8690),x=n(6343),g=n(6592);n(1755);let j=()=>{let[e,t]=(0,r.useState)("virtual_noncontrast"),[n,a]=(0,r.useState)("liver"),[o,s]=(0,r.useState)([]),l=[{id:"virtual_noncontrast",label:"虚拟平扫"},{id:"iodine_overlay",label:"碘叠加"},{id:"bone_subtraction",label:"骨骼减除"},{id:"lung_perfusion",label:"肺灌注"}];return(0,r.useEffect)(()=>{s({liver:[{name:"软组织",conventional:65,virtual_noncontrast:65,iodine_overlay:65,bone_subtraction:70,lung_perfusion:65},{name:"脂肪",conventional:15,virtual_noncontrast:15,iodine_overlay:15,bone_subtraction:15,lung_perfusion:15},{name:"碘",conventional:15,virtual_noncontrast:0,iodine_overlay:15,bone_subtraction:15,lung_perfusion:15},{name:"骨骼",conventional:5,virtual_noncontrast:5,iodine_overlay:5,bone_subtraction:0,lung_perfusion:5},{name:"空气",conventional:0,virtual_noncontrast:0,iodine_overlay:0,bone_subtraction:0,lung_perfusion:0}],lung:[{name:"软组织",conventional:30,virtual_noncontrast:30,iodine_overlay:30,bone_subtraction:35,lung_perfusion:30},{name:"脂肪",conventional:5,virtual_noncontrast:5,iodine_overlay:5,bone_subtraction:5,lung_perfusion:5},{name:"碘",conventional:10,virtual_noncontrast:0,iodine_overlay:10,bone_subtraction:10,lung_perfusion:10},{name:"骨骼",conventional:15,virtual_noncontrast:15,iodine_overlay:15,bone_subtraction:0,lung_perfusion:15},{name:"空气",conventional:40,virtual_noncontrast:40,iodine_overlay:40,bone_subtraction:50,lung_perfusion:40}],kidney:[{name:"软组织",conventional:60,virtual_noncontrast:60,iodine_overlay:60,bone_subtraction:65,lung_perfusion:60},{name:"脂肪",conventional:20,virtual_noncontrast:20,iodine_overlay:20,bone_subtraction:20,lung_perfusion:20},{name:"碘",conventional:10,virtual_noncontrast:0,iodine_overlay:10,bone_subtraction:10,lung_perfusion:10},{name:"骨骼",conventional:5,virtual_noncontrast:5,iodine_overlay:5,bone_subtraction:0,lung_perfusion:5},{name:"钙（结石）",conventional:5,virtual_noncontrast:15,iodine_overlay:5,bone_subtraction:5,lung_perfusion:5}]}[n])},[n]),(0,i.jsxs)(b.Z,{title:"双能重建模拟器",children:[(0,i.jsxs)("div",{className:"mb-4 space-y-4",children:[i.jsx("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:i.jsx(x.Z,{label:"选择病例",options:[{id:"liver",name:"肝脏病变"},{id:"lung",name:"肺栓塞"},{id:"kidney",name:"肾结石"}],value:n,onChange:a})}),i.jsx(g.Z,{tabs:l,activeTab:e,onChange:t}),(0,i.jsxs)("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[(0,i.jsxs)("div",{className:"rounded-md border border-border bg-bg-100 p-4",children:[i.jsx("div",{className:"mb-2 text-sm font-medium text-text-100",children:"常规CT图像"}),i.jsx("div",{className:"aspect-square w-full overflow-hidden rounded-md bg-black",children:(0,i.jsxs)("div",{className:"relative h-full w-full",children:[(0,i.jsxs)("div",{className:"absolute inset-0 flex items-center justify-center",children:["liver"===n&&i.jsx("div",{className:"h-3/4 w-3/4 rounded-full bg-gray-700",children:(0,i.jsxs)("div",{className:"relative h-full w-full",children:[i.jsx("div",{className:"absolute left-1/4 top-1/4 h-1/4 w-1/4 rounded-full bg-gray-500"}),i.jsx("div",{className:"absolute bottom-1/4 right-1/4 h-1/6 w-1/6 rounded-full bg-gray-500"})]})}),"lung"===n&&i.jsx("div",{className:"h-3/4 w-3/4 rounded-md bg-gray-900",children:(0,i.jsxs)("div",{className:"relative h-full w-full",children:[i.jsx("div",{className:"absolute left-1/4 top-1/4 h-1/3 w-1/3 rounded-full bg-gray-800"}),i.jsx("div",{className:"absolute bottom-1/4 right-1/4 h-1/3 w-1/3 rounded-full bg-gray-800"}),i.jsx("div",{className:"absolute left-1/2 top-1/2 h-1/6 w-1/6 -translate-x-1/2 -translate-y-1/2 rounded-full bg-gray-600"})]})}),"kidney"===n&&i.jsx("div",{className:"h-3/4 w-3/4 rounded-md bg-gray-700",children:(0,i.jsxs)("div",{className:"relative h-full w-full",children:[i.jsx("div",{className:"absolute left-1/4 top-1/4 h-1/3 w-1/4 rounded-full bg-gray-600"}),i.jsx("div",{className:"absolute bottom-1/4 right-1/4 h-1/3 w-1/4 rounded-full bg-gray-600"}),i.jsx("div",{className:"absolute left-1/2 top-1/2 h-1/8 w-1/8 -translate-x-1/2 -translate-y-1/2 rounded-full bg-white"})]})})]}),i.jsx("div",{className:"absolute bottom-2 left-2 rounded bg-black bg-opacity-50 px-2 py-1 text-xs text-white",children:"常规单能CT"})]})})]}),(0,i.jsxs)("div",{className:"rounded-md border border-border bg-bg-100 p-4",children:[i.jsx("div",{className:"mb-2 text-sm font-medium text-text-100",children:"双能CT重建"}),i.jsx("div",{className:"aspect-square w-full overflow-hidden rounded-md bg-black",children:(0,i.jsxs)("div",{className:"relative h-full w-full",children:[(0,i.jsxs)("div",{className:"absolute inset-0 flex items-center justify-center",children:["liver"===n&&"virtual_noncontrast"===e&&i.jsx("div",{className:"h-3/4 w-3/4 rounded-full bg-gray-600",children:(0,i.jsxs)("div",{className:"relative h-full w-full",children:[i.jsx("div",{className:"absolute left-1/4 top-1/4 h-1/4 w-1/4 rounded-full bg-gray-500"}),i.jsx("div",{className:"absolute bottom-1/4 right-1/4 h-1/6 w-1/6 rounded-full bg-gray-500"})]})}),"liver"===n&&"iodine_overlay"===e&&i.jsx("div",{className:"h-3/4 w-3/4 rounded-full bg-gray-700",children:(0,i.jsxs)("div",{className:"relative h-full w-full",children:[i.jsx("div",{className:"absolute left-1/4 top-1/4 h-1/4 w-1/4 rounded-full bg-blue-500"}),i.jsx("div",{className:"absolute bottom-1/4 right-1/4 h-1/6 w-1/6 rounded-full bg-blue-500"})]})}),"lung"===n&&"lung_perfusion"===e&&i.jsx("div",{className:"h-3/4 w-3/4 rounded-md bg-gray-900",children:(0,i.jsxs)("div",{className:"relative h-full w-full",children:[i.jsx("div",{className:"absolute left-1/4 top-1/4 h-1/3 w-1/3 rounded-full bg-gray-800"}),i.jsx("div",{className:"absolute bottom-1/4 right-1/4 h-1/3 w-1/3 rounded-full bg-gray-800"}),i.jsx("div",{className:"absolute left-1/2 top-1/2 h-1/6 w-1/6 -translate-x-1/2 -translate-y-1/2 rounded-full bg-red-600"})]})}),"kidney"===n&&"virtual_noncontrast"===e&&i.jsx("div",{className:"h-3/4 w-3/4 rounded-md bg-gray-600",children:(0,i.jsxs)("div",{className:"relative h-full w-full",children:[i.jsx("div",{className:"absolute left-1/4 top-1/4 h-1/3 w-1/4 rounded-full bg-gray-500"}),i.jsx("div",{className:"absolute bottom-1/4 right-1/4 h-1/3 w-1/4 rounded-full bg-gray-500"}),i.jsx("div",{className:"absolute left-1/2 top-1/2 h-1/8 w-1/8 -translate-x-1/2 -translate-y-1/2 rounded-full bg-white"})]})}),("liver"===n&&("bone_subtraction"===e||"lung_perfusion"===e)||"lung"===n&&("virtual_noncontrast"===e||"iodine_overlay"===e||"bone_subtraction"===e)||"kidney"===n&&("iodine_overlay"===e||"bone_subtraction"===e||"lung_perfusion"===e))&&i.jsx("div",{className:"flex h-full w-full items-center justify-center text-white",children:i.jsx("p",{children:"此重建类型不适用于当前病例"})})]}),i.jsx("div",{className:"absolute bottom-2 left-2 rounded bg-black bg-opacity-50 px-2 py-1 text-xs text-white",children:l.find(t=>t.id===e)?.label||""})]})})]})]}),(0,i.jsxs)("div",{className:"rounded-md border border-border bg-bg-100 p-4",children:[i.jsx("div",{className:"mb-2 text-sm font-medium text-text-100",children:"材料分解"}),i.jsx("div",{className:"h-64 w-full md:h-72",children:i.jsx(c.h,{width:"100%",height:"100%",children:(0,i.jsxs)(u.v,{data:o,margin:{top:20,right:30,left:20,bottom:5},layout:"vertical",children:[i.jsx(m.q,{strokeDasharray:"3 3"}),i.jsx(p.K,{type:"number",domain:[0,100],label:{value:"百分比 (%)",position:"insideBottom",offset:-5}}),i.jsx(h.B,{dataKey:"name",type:"category",width:80}),i.jsx(f.u,{formatter:e=>[`${e}%`,"比例"]}),i.jsx(v.D,{}),i.jsx(y.$,{dataKey:"conventional",name:"常规CT",fill:"#cccccc",radius:[0,4,4,0]}),i.jsx(y.$,{dataKey:e,name:l.find(t=>t.id===e)?.label||"",fill:"#FF8C00",radius:[0,4,4,0]})]})})})]})]}),(0,i.jsxs)("div",{className:"rounded-md bg-bg-200 p-4 text-sm text-text-200",children:[i.jsx("h3",{className:"mb-2 font-medium text-text-100",children:"说明"}),i.jsx("p",{children:"此模拟器展示了双能CT的不同重建类型："}),(0,i.jsxs)("ul",{className:"mt-2 list-inside list-disc space-y-1",children:[(0,i.jsxs)("li",{children:[i.jsx("span",{className:"font-medium",children:"虚拟平扫"}),"：移除碘造影剂的影响，模拟未注射造影剂的图像"]}),(0,i.jsxs)("li",{children:[i.jsx("span",{className:"font-medium",children:"碘叠加"}),"：突出显示含碘区域，有助于识别高血供病变"]}),(0,i.jsxs)("li",{children:[i.jsx("span",{className:"font-medium",children:"骨骼减除"}),"：移除骨骼，便于观察血管和软组织"]}),(0,i.jsxs)("li",{children:[i.jsx("span",{className:"font-medium",children:"肺灌注"}),"：评估肺部血流，有助于诊断肺栓塞"]})]}),i.jsx("p",{className:"mt-2",children:"不同的重建类型适用于不同的临床情况，材料分解图表显示了各种重建方法如何改变图像中不同材料的表现。"})]})]})};var _=n(6601),w=n(3958),N=n(5586),P=n.n(N),k=n(119),A=n.n(k),C=n(1711),T=n.n(C),S=n(1135),O=n(6195),E=n(1595),X=n(9432),D=n(5588),L=n(2582),F=n(2645),Z=n(2656),I=n(1656),K=n(1546),B=["type","layout","connectNulls","ref"],$=["key"];function q(e){return(q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function M(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function V(){return(V=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}function W(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function R(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?W(Object(n),!0).forEach(function(t){Y(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):W(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function z(e){return function(e){if(Array.isArray(e))return G(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return G(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return G(e,void 0)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function G(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}function H(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,ee(i.key),i)}}function U(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(U=function(){return!!e})()}function J(e){return(J=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Q(e,t){return(Q=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function Y(e,t,n){return(t=ee(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ee(e){var t=function(e,t){if("object"!=q(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=q(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==q(t)?t:t+""}var et=function(e){var t,n;function i(){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,i);for(var e,t,n,r=arguments.length,a=Array(r),o=0;o<r;o++)a[o]=arguments[o];return t=i,n=[].concat(a),t=J(t),Y(e=function(e,t){if(t&&("object"===q(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,U()?Reflect.construct(t,n||[],J(this).constructor):t.apply(this,n)),"state",{isAnimationFinished:!0,totalLength:0}),Y(e,"generateSimpleStrokeDasharray",function(e,t){return"".concat(t,"px ").concat(e-t,"px")}),Y(e,"getStrokeDasharray",function(t,n,r){var a=r.reduce(function(e,t){return e+t});if(!a)return e.generateSimpleStrokeDasharray(n,t);for(var o=t%a,s=n-t,l=[],d=0,c=0;d<r.length;c+=r[d],++d)if(c+r[d]>o){l=[].concat(z(r.slice(0,d)),[o-c]);break}var u=l.length%2==0?[0,s]:[s];return[].concat(z(i.repeat(r,Math.floor(t/a))),z(l),u).map(function(e){return"".concat(e,"px")}).join(", ")}),Y(e,"id",(0,F.EL)("recharts-line-")),Y(e,"pathRef",function(t){e.mainCurve=t}),Y(e,"handleAnimationEnd",function(){e.setState({isAnimationFinished:!0}),e.props.onAnimationEnd&&e.props.onAnimationEnd()}),Y(e,"handleAnimationStart",function(){e.setState({isAnimationFinished:!1}),e.props.onAnimationStart&&e.props.onAnimationStart()}),e}return function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Q(e,t)}(i,e),t=[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var e=this.getTotalLength();this.setState({totalLength:e})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var e=this.getTotalLength();e!==this.state.totalLength&&this.setState({totalLength:e})}}},{key:"getTotalLength",value:function(){var e=this.mainCurve;try{return e&&e.getTotalLength&&e.getTotalLength()||0}catch(e){return 0}}},{key:"renderErrorBar",value:function(e,t){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var n=this.props,i=n.points,r=n.xAxis,o=n.yAxis,s=n.layout,l=n.children,d=(0,Z.NN)(l,L.W);if(!d)return null;var c=function(e,t){return{x:e.x,y:e.y,value:e.value,errorVal:(0,K.F$)(e.payload,t)}};return a().createElement(X.m,{clipPath:e?"url(#clipPath-".concat(t,")"):null},d.map(function(e){return a().cloneElement(e,{key:"bar-".concat(e.props.dataKey),data:i,xAxis:r,yAxis:o,layout:s,dataPointFormatter:c})}))}},{key:"renderDots",value:function(e,t,n){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var r=this.props,o=r.dot,s=r.points,l=r.dataKey,d=(0,Z.L6)(this.props,!1),c=(0,Z.L6)(o,!0),u=s.map(function(e,t){var n=R(R(R({key:"dot-".concat(t),r:3},d),c),{},{index:t,cx:e.x,cy:e.y,value:e.value,dataKey:l,payload:e.payload,points:s});return i.renderDotItem(o,n)}),m={clipPath:e?"url(#clipPath-".concat(t?"":"dots-").concat(n,")"):null};return a().createElement(X.m,V({className:"recharts-line-dots",key:"dots"},m),u)}},{key:"renderCurveStatically",value:function(e,t,n,i){var r=this.props,o=r.type,s=r.layout,l=r.connectNulls,d=(r.ref,M(r,B)),c=R(R(R({},(0,Z.L6)(d,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:t?"url(#clipPath-".concat(n,")"):null,points:e},i),{},{type:o,layout:s,connectNulls:l});return a().createElement(O.H,V({},c,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(e,t){var n=this,i=this.props,r=i.points,o=i.strokeDasharray,s=i.isAnimationActive,l=i.animationBegin,d=i.animationDuration,c=i.animationEasing,u=i.animationId,m=i.animateNewValues,p=i.width,h=i.height,f=this.state,v=f.prevPoints,y=f.totalLength;return a().createElement(w.ZP,{begin:l,duration:d,isActive:s,easing:c,from:{t:0},to:{t:1},key:"line-".concat(u),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(i){var a,s=i.t;if(v){var l=v.length/r.length,d=r.map(function(e,t){var n=Math.floor(t*l);if(v[n]){var i=v[n],r=(0,F.k4)(i.x,e.x),a=(0,F.k4)(i.y,e.y);return R(R({},e),{},{x:r(s),y:a(s)})}if(m){var o=(0,F.k4)(2*p,e.x),d=(0,F.k4)(h/2,e.y);return R(R({},e),{},{x:o(s),y:d(s)})}return R(R({},e),{},{x:e.x,y:e.y})});return n.renderCurveStatically(d,e,t)}var c=(0,F.k4)(0,y)(s);if(o){var u="".concat(o).split(/[,\s]+/gim).map(function(e){return parseFloat(e)});a=n.getStrokeDasharray(c,y,u)}else a=n.generateSimpleStrokeDasharray(y,c);return n.renderCurveStatically(r,e,t,{strokeDasharray:a})})}},{key:"renderCurve",value:function(e,t){var n=this.props,i=n.points,r=n.isAnimationActive,a=this.state,o=a.prevPoints,s=a.totalLength;return r&&i&&i.length&&(!o&&s>0||!T()(o,i))?this.renderCurveWithAnimation(e,t):this.renderCurveStatically(i,e,t)}},{key:"render",value:function(){var e,t=this.props,n=t.hide,i=t.dot,r=t.points,o=t.className,s=t.xAxis,l=t.yAxis,d=t.top,c=t.left,u=t.width,m=t.height,p=t.isAnimationActive,h=t.id;if(n||!r||!r.length)return null;var f=this.state.isAnimationFinished,v=1===r.length,y=(0,S.Z)("recharts-line",o),b=s&&s.allowDataOverflow,x=l&&l.allowDataOverflow,g=b||x,j=A()(h)?this.id:h,_=null!==(e=(0,Z.L6)(i,!1))&&void 0!==e?e:{r:3,strokeWidth:2},w=_.r,N=_.strokeWidth,P=((0,Z.jf)(i)?i:{}).clipDot,k=void 0===P||P,C=2*(void 0===w?3:w)+(void 0===N?2:N);return a().createElement(X.m,{className:y},b||x?a().createElement("defs",null,a().createElement("clipPath",{id:"clipPath-".concat(j)},a().createElement("rect",{x:b?c:c-u/2,y:x?d:d-m/2,width:b?u:2*u,height:x?m:2*m})),!k&&a().createElement("clipPath",{id:"clipPath-dots-".concat(j)},a().createElement("rect",{x:c-C/2,y:d-C/2,width:u+C,height:m+C}))):null,!v&&this.renderCurve(g,j),this.renderErrorBar(g,j),(v||i)&&this.renderDots(g,k,j),(!p||f)&&D.e.renderCallByParent(this.props,r))}}],n=[{key:"getDerivedStateFromProps",value:function(e,t){return e.animationId!==t.prevAnimationId?{prevAnimationId:e.animationId,curPoints:e.points,prevPoints:t.curPoints}:e.points!==t.curPoints?{curPoints:e.points}:null}},{key:"repeat",value:function(e,t){for(var n=e.length%2!=0?[].concat(z(e),[0]):e,i=[],r=0;r<t;++r)i=[].concat(z(i),z(n));return i}},{key:"renderDotItem",value:function(e,t){var n;if(a().isValidElement(e))n=a().cloneElement(e,t);else if(P()(e))n=e(t);else{var i=t.key,r=M(t,$),o=(0,S.Z)("recharts-line-dot","boolean"!=typeof e?e.className:"");n=a().createElement(E.o,V({key:i},r,{className:o}))}return n}}],t&&H(i.prototype,t),n&&H(i,n),Object.defineProperty(i,"prototype",{writable:!1}),i}(r.PureComponent);Y(et,"displayName","Line"),Y(et,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!I.x.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1}),Y(et,"getComposedData",function(e){var t=e.props,n=e.xAxis,i=e.yAxis,r=e.xAxisTicks,a=e.yAxisTicks,o=e.dataKey,s=e.bandSize,l=e.displayedData,d=e.offset,c=t.layout;return R({points:l.map(function(e,t){var l=(0,K.F$)(e,o);return"horizontal"===c?{x:(0,K.Hv)({axis:n,ticks:r,bandSize:s,entry:e,index:t}),y:A()(l)?null:i.scale(l),value:l,payload:e}:{x:A()(l)?null:n.scale(l),y:(0,K.Hv)({axis:i,ticks:a,bandSize:s,entry:e,index:t}),value:l,payload:e}}),layout:c},d)});var en=n(1327),ei=(0,_.z)({chartName:"LineChart",GraphicalChild:et,axisComponents:[{axisType:"xAxis",AxisComp:p.K},{axisType:"yAxis",AxisComp:h.B}],formatAxisMap:en.t9}),er=n(9522);let ea=()=>{let[e,t]=(0,r.useState)("soft_tissue"),[n,a]=(0,r.useState)(5),[o,s]=(0,r.useState)([]),l=[{id:"soft_tissue",name:"软组织（如肌肉）"},{id:"fat",name:"脂肪"},{id:"bone",name:"骨骼"},{id:"iodine",name:"碘造影剂"},{id:"iodine_enhanced",name:"碘增强器官"},{id:"water",name:"水"},{id:"air",name:"空气"}];(0,r.useEffect)(()=>{(()=>{let e=[];for(let t=20;t<=140;t+=5){let i={energy:t,soft_tissue:d("soft_tissue",t),fat:d("fat",t),bone:d("bone",t),iodine:d("iodine",t,n),iodine_enhanced:d("iodine_enhanced",t,n),water:d("water",t),air:d("air",t)};e.push(i)}s(e)})()},[n]);let d=(e,t,n=5)=>{let i={soft_tissue:.3,fat:.2,bone:.7,iodine:1.5,iodine_enhanced:.4,water:.25,air:.01},r=i[e]*Math.pow(80/t,2.5);return("iodine"===e||"iodine_enhanced"===e)&&t>=33&&t<40&&(r*=2.5-(t-33)*.2),"iodine"===e?r*=n/5:"iodine_enhanced"===e&&(r=i.soft_tissue*Math.pow(80/t,2.5)+n/10*i.iodine*Math.pow(80/t,2.5),t>=33&&t<40&&(r+=n/10*i.iodine*(2.5-(t-33)*.2))),r},u=e=>({soft_tissue:"#FF8C00",fat:"#FFC107",bone:"#795548",iodine:"#4A90E2",iodine_enhanced:"#003a80",water:"#00BCD4",air:"#9E9E9E"})[e]||"#000000";return(0,i.jsxs)(b.Z,{title:"X射线衰减模拟器",children:[(0,i.jsxs)("div",{className:"mb-4 space-y-4",children:[(0,i.jsxs)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[i.jsx(x.Z,{label:"选择组织类型",options:l,value:e,onChange:t}),("iodine"===e||"iodine_enhanced"===e)&&i.jsx(er.Z,{label:"碘浓度 (mg/ml)",min:1,max:10,value:n,onChange:a,step:1})]}),(0,i.jsxs)("div",{className:"rounded-md border border-border bg-bg-100 p-3 sm:p-4",children:[i.jsx("div",{className:"mb-2 text-sm font-medium text-text-100",children:"X射线能量与衰减系数关系"}),i.jsx("div",{className:"h-64 w-full md:h-80",children:i.jsx(c.h,{width:"100%",height:"100%",children:(0,i.jsxs)(ei,{data:o,margin:{top:5,right:10,left:0,bottom:5},children:[i.jsx(m.q,{strokeDasharray:"3 3"}),i.jsx(p.K,{dataKey:"energy",label:{value:"X射线能量 (keV)",position:"insideBottomRight",offset:-10}}),i.jsx(h.B,{label:{value:"衰减系数 (cm⁻\xb9)",angle:-90,position:"insideLeft"}}),i.jsx(f.u,{formatter:e=>[e.toFixed(2),"衰减系数"]}),i.jsx(v.D,{layout:"horizontal",verticalAlign:"bottom",wrapperStyle:{paddingTop:10}}),l.map(t=>i.jsx(et,{type:"monotone",dataKey:t.id,name:t.name,stroke:u(t.id),dot:!1,strokeWidth:e===t.id?3:1,opacity:e===t.id||"all"===e?1:.3},t.id))]})})})]})]}),(0,i.jsxs)("div",{className:"rounded-md bg-bg-200 p-3 text-sm text-text-200 sm:p-4",children:[i.jsx("h3",{className:"mb-2 font-medium text-text-100",children:"说明"}),i.jsx("p",{children:"此模拟器展示了不同组织在不同X射线能量下的衰减特性。注意碘在33 keV处的K边缘效应，这是双能CT的基础。"}),i.jsx("p",{className:"mt-2",children:"图表中的衰减系数是模拟值，用于教育目的。在实际临床应用中，这些值会根据具体的组织成分和密度而变化。"})]})]})},eo=JSON.parse('{"TN":"束硬化和双能CT","WL":"本页面介绍CT中的束硬化效应和双能CT技术，包括X射线能量和衰减、束硬化、双能X射线摄影和双能重建。","NS":[{"id":"xray-energy","title":"X射线能量和衰减","description":"X射线在不同能量下通过不同材料的衰减特性是双能CT的基础。","content":"为了理解双能CT，我们首先需要理解X射线在不同能量下通过不同材料的衰减特性。在诊断能量范围内，X射线与物质相互作用的两个重要物理过程是光电效应和康普顿（非相干）散射。康普顿散射在大多数材料中相对相似，但光电吸收的可能性差异很大。具体来说，光电事件的可能性与(Z/E)\xb3成正比，其中Z是原子序数，E是X射线光子能量。这意味着它强烈依赖于材料，但也重要的是依赖于X射线能量。","simulator":{"type":"xray-attenuation","options":{"tissues":[{"id":"soft_tissue","name":"软组织（如肌肉）"},{"id":"fat","name":"脂肪"},{"id":"bone","name":"骨骼"},{"id":"iodine","name":"碘造影剂"},{"id":"iodine_enhanced","name":"碘增强器官"},{"id":"water","name":"水"},{"id":"air","name":"空气"}],"iodineConcentrations":[1,2,5,8,10]}},"keyPoints":["X射线衰减主要由光电效应和康普顿散射决定","光电效应强烈依赖于材料的原子序数和X射线能量","K边缘是光电事件发生所需的最小能量","碘的K边缘在33 keV，正好在诊断X射线能量范围内","CT值（HU）与线性衰减系数直接相关，但经过标准化处理"]},{"id":"beam-hardening","title":"束硬化","description":"束硬化是X射线束通过物质时低能量X射线被优先吸收，导致平均能量增加的现象。","content":"当X射线束通过物质时，低能量的X射线比高能量的X射线更容易被吸收。这导致穿过物质的X射线束的平均能量增加，我们称这种现象为束硬化。束硬化可能导致CT图像中出现伪影，特别是在高密度物体（如金属植入物或骨骼）周围。","simulator":{"type":"beam-hardening","options":{"materials":[{"id":"aluminum","name":"铝（2.5mm）"},{"id":"titanium","name":"钛（5mm）"},{"id":"bone","name":"骨骼（1cm）"}],"kVs":[80,100,120,140]}},"keyPoints":["束硬化是X射线束通过物质时低能量X射线被优先吸收的现象","束硬化可能导致CT图像中出现伪影","滤波器可以通过预先去除低能量X射线来减少束硬化","束硬化校正算法可以在图像重建过程中减少伪影"]},{"id":"dual-energy-radiography","title":"双能X射线摄影","description":"双能X射线摄影利用不同能量X射线的衰减差异来区分不同材料。","content":"双能X射线摄影是双能CT的前身，它利用不同能量X射线的衰减差异来区分不同材料。例如，骨骼和软组织在低能量和高能量X射线下的衰减差异很大，这可以用来创建只显示软组织或只显示骨骼的图像。双能X射线摄影在骨密度测量（DXA扫描）中广泛应用。","keyPoints":["双能X射线摄影利用不同能量X射线的衰减差异来区分不同材料","它可以用来创建只显示软组织或只显示骨骼的图像","双能X射线摄影在骨密度测量中广泛应用"]},{"id":"dual-energy-ct","title":"双能CT系统","description":"双能CT系统使用两种不同能量的X射线来获取更多关于组织成分的信息。","content":"双能CT系统使用两种不同能量的X射线来获取更多关于组织成分的信息。有几种实现双能CT的方法：双源CT（两个X射线管和探测器组），快速kV切换（单个X射线管在高低kV之间快速切换），双层探测器（上层探测低能量X射线，下层探测高能量X射线）和分离束（使用滤波器将X射线束分成高能和低能部分）。","keyPoints":["双能CT使用两种不同能量的X射线来获取更多关于组织成分的信息","实现双能CT的方法包括双源CT、快速kV切换、双层探测器和分离束","双能CT可以提供常规CT无法获得的材料特性信息"]},{"id":"dual-energy-reconstruction","title":"双能重建","description":"双能CT可以进行材料分解，创建虚拟平扫、碘叠加、骨骼减除和肺灌注等特殊图像。","content":"双能CT的主要优势在于它可以进行材料分解，区分不同的材料成分。这使得可以创建多种特殊图像，包括：虚拟平扫（移除碘造影剂的影响，模拟未注射造影剂的图像），碘叠加（突出显示含碘区域），骨骼减除（移除骨骼，便于观察血管和软组织）和肺灌注（评估肺部血流）。","simulator":{"type":"dual-energy-reconstruction","options":{"reconstructionTypes":[{"id":"virtual_noncontrast","name":"虚拟平扫"},{"id":"iodine_overlay","name":"碘叠加"},{"id":"bone_subtraction","name":"骨骼减除"},{"id":"lung_perfusion","name":"肺灌注"}],"cases":[{"id":"liver","name":"肝脏病变"},{"id":"lung","name":"肺栓塞"},{"id":"kidney","name":"肾结石"}]}},"keyPoints":["双能CT可以进行材料分解，区分不同的材料成分","虚拟平扫可以减少对比剂增强检查的需求","碘叠加可以提高病变检测率","骨骼减除简化了血管和软组织的评估","肺灌注图像可以帮助评估肺栓塞"]}]}');function es(){return(0,i.jsxs)("div",{className:"space-y-8 animate-fadeIn",children:[i.jsx(o.Z,{title:eo.TN,description:eo.WL}),eo.NS.map(e=>i.jsx(s.Z,{title:e.title,description:e.description,className:"hover-lift",children:(0,i.jsxs)("div",{className:"space-y-4",children:[i.jsx("p",{className:"text-text-200",children:e.content}),e.keyPoints&&i.jsx(l.Z,{points:e.keyPoints})]})},e.id)),i.jsx(d.Z,{title:"束硬化与双能CT模拟器",children:(0,i.jsxs)(g.Z,{tabs:[{id:"attenuation",label:"X射线衰减"},{id:"dual-energy",label:"双能CT"}],children:[i.jsx("div",{id:"attenuation",className:"p-4",children:i.jsx(ea,{})}),i.jsx("div",{id:"dual-energy",className:"p-4",children:i.jsx(j,{})})]})})]})}},1755:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(326);n(7577);let r=({children:e,onClick:t,disabled:n=!1,size:r="md",className:a=""})=>i.jsx("button",{onClick:t,disabled:n,className:`rounded-md bg-primary-100 ${{sm:"px-2 py-1 text-xs",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"}[r]} font-medium text-white shadow-sm transition-colors hover:bg-primary-200 focus:outline-none focus:ring-2 focus:ring-primary-100 focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 ${a}`,children:e})},4428:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>i});let i=(0,n(8570).createProxy)(String.raw`E:\Projects\CTPhysics\app\dual-energy\page.jsx#default`)}};var t=require("../../webpack-runtime.js");t.C(e);var n=e=>t(t.s=e),i=t.X(0,[649,632,237],()=>n(4801));module.exports=i})();